\chapter{Literature Review \& Theory Description}
As previously mentioned in the introduction section, the read-out circuit we proposed has two operation mode (DC and AC).
The DC Sweep mode control the drain current ($I_D$) of nanowire while the Transient Sweep mode is for current variance measurement.
Each of them refers to different sources.
In section 2.1, we first talk about the reason why we perform $I_D$-$V_G$ sweep.
Then we review the literature related to our DC Sweep mode circuit design.
The literature related to the Transient Sweep mode circuit design is in section 2.2.
In the last section, we discuss the two assumptions mentioned in section 1.2.

\section{DC Sweep: $I_D$-$V_G$ Curves}
In this section, we review the knowledge and an article that is related to our design of large signal mode (DC).

\subsection{$I_D$-$V_G$ and Transconductance}
A common method for examining nanowire electrical properties is to perform DC sweep.
Among different sweeping methods, we choose the $I_D$-$V_G$ in respect of the physical characteristic.
The reason can be described by correlating our nanowire device with the n-type transistor.
(The S/D of our nanowire device are n-doping.)
For the n-type transistor, the threshold voltage is lowered when the substrate voltage becomes more positive.
The lower substrate voltage results in the larger $I_D$.
{\color{red}For the nanowire device, the substrate is the gate.}
When negatively charged biomolecules bind on the gate of nanowire, they decrease the surface potential.
Therefore, it is straightforward to think of these binding molecules as a voltage signal input to the gate with its value dependent on the concentration.
Moreover, this voltage signal affect the nanowire device in the same way as $V_G$ does.
So by plotting $I_D$-$V_G$  curves, we can have a thumbnail of how concentration affects the $I_D$.


\subsection{Source Follower} \label{section:SF}

\begin{figure}[h]
    \centering
    \includegraphics[width=5cm]{images/chapter2/SourceFollower.png}
    \fontsize{6}{7}\selectfont
    \caption{Sorce Follower}
    \label{fig:SF}
\end{figure}

As one of the basic single stage amplifier, source follower (common drain) are employed to transfer voltage signal from gate to source while keeping drain current constant.
The transfer function can be derived as:
\setlength{\mathindent}{5.5cm}
\begin{align}
    \frac{V_{out}}{V_{in}} & = \frac{r_{ds}g_m}{1 + r_{ds}g_m} \\    \label{eq:sfTF}
                           & \approx 1 \qquad \text{ for } \quad r_{ds}g_m >> 1
\end{align}
$g_m$ is the transconductance ($\frac{\partial I_d}{\partial V_{gs}}$) and $r_{ds}$ is the drain-to-source resistance.
Although we haven't seen the structure being applied to the nanowire, there have been several applications in the read-out circuits of ISFET (Ion-sensitive Field-effect Transistor)\cite{SF1, SF2} for a long time.

The read-out circuit in \cite{SF1} employed ISFET as a biological transducer that converts detected bio-signals into electrical signals, which resembles our nanowire biosensor.
It adopts the source follower structure as its analog front-end.
The potential change induces by the biomolecules at the gate of ISFET is converted to the source.
This structure requires a biasing current which needs to be stable, noiseless or wide-range on demand.
Since the biasing current is usually under micro-scale or even nano-scale, it is impractical to use an external current source.
The article \cite{SF1} used two resistors and an op-amp to design a current scale down circuit.
As in Fig.\ref{fig:ISFET}, bias current decreases in proportional to the resistance ratio (N) as the current source circuit $I_B$.

\begin{figure}[h]
    \centering
    \includegraphics[width=12cm]{images/chapter2/ISFET.png}
    \fontsize{6}{7}\selectfont
    \caption{ISFET readout circuit in \cite{SF1}}
    \label{fig:ISFET}
\end{figure}
The circuit in Fig.\ref{fig:ISFET} also removes the short channel effect by keeping $V_{DS}$ at a constant value (0.5v).
It adopts two op-amp based unit gain buffer to force the voltage at drain follows the source.

Attention should be paid to the impedance matching between the nano-device and the current source circuit.
The output impedance of current source should be much larger than the input impedance of the device.
The output impedance of the ISFET as a source follower is:

\begin{align}
    & \frac{r_{ds}}{1 + g_mr_{ds}}\\
\intertext{This equation can be simplified as:}
    & \frac{1}{g_m} \qquad \text{ for } \quad g_mr_{ds} >> 1 \label{eq:rsf2}
\end{align}
The output impedance of the current source $I_B$ is:
\begin{equation} \label{eq:rcs}
    N\times Z_{DS}
\end{equation}

$Z_{DS}$ is the impedance of the current source $I_{DS}$ in Fig.\ref{fig:ISFET}.
In the integrated circuit, $Z_{DS}$ is non-ideal but usually close to the $r_{ds}$ of a single MOSFET.

As mentioned, Eq.(\ref{eq:rcs}) should be far larger than Eq.(\ref{eq:rsf2}).
However, $g_m$ is proportional to $I_B$, which means Eq.(\ref{eq:rsf2}) is inversely proportional to N.
When the biasing current decreases, the output impedance of $I_B$ decreases while the input impedance at the source of ISFET increases.
This relationship determines the current.
We observed this boundary when we construct this circuit with discrete elements.
These will be presented and discussed in chapter 4.

The source follower structure provides a direct signal transition method.
It is a good candidate for the read-out circuit with the aim of detecting transconductance or threshold voltage variance.
Nevertheless, post-processing such as amplification and filtering is necessary.
The experiment results in \cite{SF1} are untreated.
Significant signal attenuation exists, which is mainly caused by low-frequency noise and ISFET drift \cite{Drift}.
The drift problem is dealt with by signal processing techniques while noise problems are left untreated.


\section{Small Signal (AC) Measurement Method Review}  \label{sec:AC}
In the previous section, the source follower we mentioned exhibited compelling advantages as a signal processing structure of nano-device.
However, the structure overcomes obstacles when being applied to the small signal detection.
Parasitic capacitors and resistors can severely influence the results.

\begin{figure}[ht]
    \centering
    \includegraphics[width=5cm]{images/chapter2/SourceFollower_wi_parasiticCap.png}
    \fontsize{6}{7}\selectfont
    \caption{Sorce Follower with parasitic capacitance}
    \label{fig:SF_pC}
\end{figure}

As in figure \ref{fig:SF_pC} where the parasitic elements are included, we modified the transfer function Eq.(\ref{eq:sfTF}) as:
\begin{align}
    \frac{V_{out}}{V_{in}} = \frac{r_{ds}(sC_{gs} + gm)}{1 + r_{ds}(gm + s(C_{gs}+C_s))}
\end{align}
The equation can be similar to Eq.(\ref{eq:sfTF}) which roughly equals to 1 as long as $C_s$ is far more smaller than $C_{gs}$.
Unfortunately, $C_s$ can be large for the output end of source follower usually connects to a next stage input or a pad.
In that case, the parasitic capacitors may attenuate the signal.

We want to build another circuit structure that can not only performs AC signal measurement but also immunes from parasitic capacitance.
We started by reviewing those works that try to measure the parasitic capacitance.
Below, the works from two teams aim to measure drain-to-source resistance ($R_{NW}$) and drain-to-source capacitance ($C_{NW}$).
The focus of the review is on the function and design theory of their read-out circuit.


\subsection{RC Time Delay Measuring}
\begin{figure}[!htbp]
    \centering
    \includegraphics[width=10cm]{images/chapter2/uv1.png}
    \caption{(a) Schematic of \cite{Juv1}.}
    \label{fig:tot1}
\end{figure}

The measurement system for ZnO-nanowire based sensor array from \cite{Juv1} applies the Time-over-Threshold techniques to its read-out circuit (Fig.\ref{fig:tot1}).
The circuit alternatively charges an on-chip capacitor ($C_{int}$) with a constant current and discharges it through the nano-material resistance (nanowire).
An inverter with its output switches from on to off when the capacitor is charged to its input threshold voltage, and vice versa.
This behavior converts information of nanowire such as capacitance and resistance into time information.
Both $C_{int}$ and $C_{NW}$ effect charging time and together with the $R_{NW}$ effect the discharging time.

The work presented in \cite{Juv1} doesn't have enough explanation about how do they interpret the capacitance and resistance information.
It merely mentioned that a microcontroller is responsible for the calculation.
Besides, the work lacks simulation and experiment of using complex elements as measured target.
Most of the results are the measurement of using a concrete resistor as the substitute for nanowire and regard the $C_{NW}$ as 0p.
The only nanowire experiment given at last doesn't have good performance.
It seems that the design may only be applied to a pure resistance or pure capacitance type element.


The recent publican \cite{Juv2} by the team is more elaborate and contains the measurement of complex elements (An element composed of a discrete resistor and a discrete capacitor).
\begin{figure}[!htbp]
    \centering
    \includegraphics[width=12cm]{images/chapter2/uv2.png}
    \caption{Schematic of \cite{Juv2}.}
    \label{fig:tot2}
\end{figure}

In Fig.\ref{fig:tot2}, nanowire append between point A and B.
The charging current can be applied from Mp1 or Mp2, which is determined by the ``sel'' signal with the aid from the MUXs.
We simply assume sel = 1 and point B is virtually ground.
(When the sel = 0, the circuit measures the element with a reversed biasing current.)
Now, we can see that the circuit design concept is same with \cite{Juv1}.
The current charge both $C_{int}$ and $C_{NW}$.
When the voltage at A exceed the threshold voltage, the output switches to off and feedback to turn off the Mp1.
(To be noted that a Schmitt trigger replaces the inverter at the output stage in \cite{Juv1}.)
Then the capacitor discharges through nanowire ($r_{ds}$).

The right-bottom plot in Fig.\ref{fig:tot2} defines $T_0$ as the charging time and $T_1$ as the discharging time.
The calculation of the $R_{NW}$ and $C_{NW}$  can be simplified as:
\setlength{\mathindent}{2cm}
\begin{align}
                         C_{NW}            & = T_0 - C_{base}\\
                         R_{NW}            & = \frac{T_1R_{par}}{(C_{NW} + C_{base})R_{par} - T_1}\\
    \text{where} \qquad  R_{NW} || R_{par} & = \frac{T_1}{C_{NW} + C_{base}}
\end{align}
$C_{base}$ are the $C_{int}$ plus parasitic capacitance and $R_{par}$ the parasitic resistance.
These parasitic elements come from the transistor in the integrated circuit block such as MUX and Mp.
It must be noticed that we don't concern the hysteresis of the Schmitt trigger here owing to simplicity.


\subsection{Complex Impedance Solving}
The nanowire-based hydrogen sensor measurement system from \cite{Jlockin} adopts another method.
It treat
It use a lock-in amplifier to realize both resistive and capacitive impedance measurement.

\begin{figure}[!htbp]
        \centering
        \includegraphics[width=13cm]{images/chapter2/lockin.png}
        \caption{Block diagram of the lock-in amplifier in \cite{Jlockin}}
        \label{fig:lockin}
\end{figure}

As the previous method, it treats nanowire as a complexed one-dimensional element. The nanowire is modeled as a parallel aligned resistor and a capacitor.
The system supplies a sinusoidal voltage signal to one end of the element.
Another end of the element is grounded virtually by a transimpedance amplifier (TIA).
The TIA then converts the current variance into voltage output which contains complex impedance information.
The resistance is in the real part while the capacitance is in the virtual part.
\setlength{\mathindent}{5.5cm}
\begin{align}
    V_{out} &= I_{NW}R_{TIA} \\
    I_{NW} &= V_{in}(\frac{1}{R_{NW}} + j 2\pi fC_{NW})
\end{align}
$f$ is the frequency of input signal.

The output of TIA is followed by a controllable bandpass filter (BP).
The BP removes high-order harmonic interferences.
Then the signal is demodulated.
The resistive and capacitive impedance values are resolved through two channels: I and Q with their phase different by 90 degrees.
A mixer which is a linear multiplier performs the demodulation.
With a radio frequency (RF) input and the input local oscillator (LO) input, it produce an output signal that consists of signals with frequencies $f_{RF} + f_{LO}$ and $f_{RF} - f_{LO}$.
Incidentally, the signal is immune from the perturbation of low-frequency noise which is a common problem for the biosensor.

\subsection{Comparison and Conclusion} \label{sec:ch2CC}
We compare Method 1 (Sec.2.2.1) and Method 2 (Sec.2.2.2) here.
Both of them focus on detecting the $R_{NW}$ difference.
According to the comparison table below (\ref{tb:LVtable}), we can see the resistor measurement range of Method 1 is different from Method 2 by a large extent.
This may because the bias current of nanowire that caprovided by the circuits are different.
The current in Method 1 is limited by the pmos(I charge) and the leakage current.
In Method 2, it is limited by the TIA.
Our method adopts this TIA block and will discuss this problem in section.\ref{sec:Ibias}.

Method 2 perform well when it comes to noise suppression.
In fact, the circuit in Method 1 doesn't provide noise reduction ability.
The particular structure it uses (The article \cite{Juv1} mentioned it as M4N approach) is the one responsible for that.

Method 1 has a lower power consumption. However, it doesn't include the power of microcontroller and may underestimate.

\begin{table}[!htb]
    {\fontfamily{}\fontsize{10}{14}\selectfont
    \centering
    \begin{tabular}{l|cp{4cm}}
        & \cite{Juv2} & \cite{Jlockin}\\
        \hline
        R meas range & 1M - 1G & 10 - 40k\\
        \hline
        R meas error & < 2.5\% & < 2\%\\
        \hline
        C meas range & 100fF - 1uF & 0.5 - 1.8nF\\
        \hline
        C meas error & < 3\% & < 3\%\\
        \hline
        SNR & > 45dB & - \\
        \hline
        Input refered noise & - & 190 nV/sqrt(Hz) @ 5 kHz \\
        \hline
        CMOS Technology & 0.13um & 0.18um\\
        \hline
        Power consumption & 14.82uW & 2mW\\
    \end{tabular}
    \caption{Specification Summary}
    \label{tb:LVtable}
    }
\end{table}

In our project, capacitance measurement is not our object.
But we still need to consider the parasitic capacitor effect in our circuit design.
Method 1 converts the resistance information into time (frequency) information.
If one want to avoid the effect of the parasitic capacitor, he should apply a $C_{int}$ that is much larger than $C_{NW}$.
However, it is not practical in integrated design because the chip size is limited.

Method 2 uses a TIA to measure resistance and capacitance together first and then resolve the complex value.
We can write the complex impedance value as:
\begin{align}
      \frac{R_{NW}}{1 + i2\pi f R_{NW} C_{NW}} \label{eq:comlex}
\end{align}
In Eq.(\ref{eq:comlex}), $i$ is the imaginary unit and $f$ is the signal frequency.
The equation can be simplified as $R_{NW}$ when $i2\pi f R_{NW} C_{NW} < 0.1$.
The simplification can be applied when the signal frequency or $C_{NW} R_{NW}$ is small enough.
Thus, one needs to select the appropriate signal frequency or to determine the $R_{NW}$ detecting range.

Another reason that makes Method 2 more attractive is that it is more flexible.
One can add other analog blocks such as noise filter or amplifier to it.

Overall, Method 1 has the advantage in detecting range and accuracy while Method 2 has better noise suppression and flexibility.



\section{Two assumption for Dealing with Disparity Problem} \label{sec:assumpDiscuss}
In chapter 1, to deal with disparity problem, we assume that:
\begin{enumerate}
    \item The nanowire transconductance ($g_m = \frac{\partial I_D}{\partial V_{GS}}$) depends on $I_D$ and independent on $V_{GS}$.
    \item The concentration difference of biomolecule can be viewed as a voltage signal input to the gate end of a transistor.
\end{enumerate}
We discuss them in this section.

\subsection{Transconductance and $I_D$} \label{section:IdGm}
With the MOSFET model of weak and strong inversion, we have the $I_D$ equations of MOSFET:
\setlength{\mathindent}{1.5cm}

\begin{align}
    \text{weak inversion:} \quad I_D   = & I_0e^{\kappa V_{GS}/\phi_t}(1 - e^{-V_{DS}/\phi_t})\\  \label{eq:Ikappa}
                                       = & I_0e^{\kappa V_{GS}/\phi_t} \quad \text{where $V_{DS} > 4 \phi_t$ } \\
    \text{strong inversion:} \quad I_D = & \mu C_{ox} \frac{W}{L}((V_{GS} - V_{th})V_{DS} - \frac{V_{DS}^2}{2}) \\
                                       = & \mu C_{ox} \frac{W}{L}(V_{GS} - V_{th})^2 \quad \text{where $V_{DS} > V_{GS} - V_{th}$} \label{eq:ID_Strong}
\end{align}

$C_{ox}$ is the oxide capacitance and $\mu$ is the electron mobility.
Both of them depends on doping concentration.
$W$ and $L$ are the width and length of the transistor.
$\phi_t$ is the thermal voltage depending on temperature.
The $\kappa$ is the gate coupling coefficient.
It will be discuss in the next paragraph.
To be noted that we ignore the short channel effect, which doesn't effect our discussion since we always keep $V_{DS}$ constant.

We then derive $g_m$:
\begin{align}
    \text{weak inversion:} \quad g_m & = \frac{\kappa I_D}{\phi_t}\\ \label{eq:gm_weak}
    \text{strong inversion:} \quad g_m & = \sqrt{2 \mu C_{ox} (\frac{W}{L})I_{D}} \\ \label{eq:gm_strong}
\end{align}

For the strong inversion, the Eq.(\ref{eq:gm_strong}) shows that the assumption 1 is correct.
However, the assumption is not completely right for transistor in weak inversion.
According to the Eq.(\ref{eq:gm_weak}), the $g_m$ is effect not only by $I_D$ but also by the $\kappa$.
It is a non-linear parameter effected by $V_G$ and other factors.
Its value is range from 0.4 to 0.9.
In our circuit, this problem is currently left unsolved.
We present its effect in chapter 6.


\subsection{A Simple Model for Concentration Affect}
In \cite{DN17}, the team plot the $I_D$-$V_G$ curves and study how the curve changes with the concentration of biomolecules.
We observe that in the plot (Fig.\ref{fig:DN17Fig6d}) with a log scale for the y-axis, curves with different concentration exhibit a same rising trend when $I_D$ is low (< 100nA).
Each curve seems to be different with the other by a constant fold.
By applying the weak inversion current equation of MOSFET, we found that the assumption can explain this concentration effect.

\begin{align}
    & I_D1 = I_{0} e^{\kappa(V_{GS} - V_{th}) / \phi_t} \\
    & I_D2 = I_{0} e^{\kappa(V_{GS} - (V_{th} - v_c)) / \phi_t} \\
    \rightarrow & I_D2 = f(v_c) \times I_D1 \quad \text{where} \quad f(\Delta v_g) = e^{v_c / \phi_t} \label{eq:vc}
\end{align}

The $I_D1$ and $I_D2$ are the current of two nanowire elements placed in solutions of different concentration.
The ($v_c$) is a concentration related variable we create.
The Eq.(\ref{eq:vc}) implies that when nanowire is in weak inversion region, its $\log I_D$ difference is independent of $V_g$.
\begin{align}
    \log I_D2 - \log I_D1 = \log \frac{I_D2}{I_D1} = \log f(v_c) = v_c / \phi_t
\end{align}

As for strong inversion region which refer to the large current section in Fig.\ref{fig:DN17Fig6d}, the difference of the curves diminish as $V_G$ increasing.
The strong inversion equation Eq.(\ref{eq:ID_Strong}) shows that if $V_{GS}$ is far larger then $v_c$, the concentration effect can be ignored.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=8cm]{images/chapter2/DN18Fig3D.png}
    \caption{Concentration-dependent electric response($I_D-V_G$) of biotin-modified poly-Si NWFET following biotinâ€“streptavidin interaction.\cite{DN17}}
    \label{fig:DN17Fig6d}
\end{figure}

We will further prove the two assumptions by the data of biology experiment in section.\ref{section:disparityBio}.









%
